{{ template "header.html" . }}

<div class="flex justify-between items-center mb-6">
    <div>
        <h1>Analytics</h1>
    </div>
    <div class="flex gap-2 items-end">
        <div class="dropdown" id="analyticsDateDropdown">
            <button class="btn btn-secondary btn-icon" id="analyticsDateBtn" type="button">
                <i data-lucide="calendar"></i> <span class="filter-btn-label" id="analyticsDateLabel">Dates</span> <i data-lucide="chevron-down" class="icon-chevron-down"></i>
            </button>
            <div class="filter-dropdown date-filter-dropdown p-3" id="analyticsDateMenu">
                <div class="mb-4">
                    <label class="form-label-bold mb-2">Suggested</label>
                    <div class="flex flex-wrap gap-2">
                        <button class="btn btn-sm btn-ghost analytics-date-suggestion" data-range="today">Today</button>
                        <button class="btn btn-sm btn-ghost analytics-date-suggestion" data-range="yesterday">Yesterday</button>
                        <button class="btn btn-sm btn-ghost analytics-date-suggestion" data-range="thisWeek">This Week</button>
                        <button class="btn btn-sm btn-ghost analytics-date-suggestion" data-range="thisMonth">This Month</button>
                        <button class="btn btn-sm btn-ghost analytics-date-suggestion" data-range="thisYear">This Year</button>
                        <button class="btn btn-sm btn-ghost analytics-date-suggestion" data-range="last7">Last 7 Days</button>
                        <button class="btn btn-sm btn-ghost analytics-date-suggestion" data-range="last30">Last 30 Days</button>
                        <button class="btn btn-sm btn-ghost analytics-date-suggestion" data-range="last365">Last 365 Days</button>
                    </div>
                </div>
                <div class="mb-2 border-t pt-2">
                    <label class="form-label-bold mb-2">Custom</label>
                </div>
                <div class="form-group mb-sm">
                    <label class="form-label">Start Date</label>
                    <input type="date" id="analyticsStartDate" class="form-input dropdown-input" />
                </div>
                <div class="form-group mb-4">
                    <label class="form-label">End Date</label>
                    <input type="date" id="analyticsEndDate" class="form-input dropdown-input" />
                </div>
                <div class="flex justify-between pt-2">
                    <button class="btn btn-sm btn-ghost" id="analyticsClearDates">Clear</button>
                    <button class="btn btn-sm btn-primary" id="analyticsApplyDates">Apply</button>
                </div>
            </div>
        </div>
        <div class="dropdown" id="analyticsPostTypesDropdown">
            <button class="btn btn-secondary btn-icon" id="analyticsPostTypesBtn" type="button">
                <i data-lucide="layers"></i> <span class="filter-btn-label" id="analyticsPostTypesLabel">Post Types</span> <i data-lucide="chevron-down" class="icon-chevron-down"></i>
            </button>
            <div class="filter-dropdown p-3" id="analyticsPostTypesMenu" style="min-width: 180px">
                <div class="flex justify-between mb-2">
                    <button class="btn btn-sm btn-ghost" id="analyticsPostTypesSelectAll">All</button>
                    <button class="btn btn-sm btn-ghost" id="analyticsPostTypesClear">None</button>
                </div>
                <div id="analyticsPostTypesOptions"></div>
                <div class="flex justify-end mt-2">
                    <button class="btn btn-sm btn-primary" id="analyticsApplyPostTypes">Apply</button>
                </div>
            </div>
        </div>
        <div class="dropdown" id="analyticsModeDropdown">
            <button class="btn btn-secondary btn-icon" id="analyticsModeBtn" type="button">
                <i data-lucide="gauge"></i> <span class="filter-btn-label" id="analyticsModeLabel">Mode: Likes</span> <i data-lucide="chevron-down" class="icon-chevron-down"></i>
            </button>
            <div class="filter-dropdown p-3" id="analyticsModeMenu" style="min-width: 150px">
                <div id="analyticsModeOptions">
                    <label class="flex items-center gap-2 py-1 cursor-pointer">
                        <input type="radio" name="analyticsMode" class="analytics-mode-radio" value="likes" checked> Likes
                    </label>
                    <label class="flex items-center gap-2 py-1 cursor-pointer">
                        <input type="radio" name="analyticsMode" class="analytics-mode-radio" value="views"> Views
                    </label>
                </div>
                <div class="flex justify-end mt-2">
                    <button class="btn btn-sm btn-primary" id="analyticsApplyMode">Apply</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="tabs mb-6">
    <button class="tab-btn active" data-tab="content">Content</button>
    <button class="tab-btn" data-tab="engagement">Engagement</button>
    <button class="tab-btn" data-tab="timing">Timing</button>
    <button class="tab-btn" data-tab="wordcloud">Word Cloud</button>
    <button class="tab-btn" data-tab="website">Website</button>
</div>

<div id="content-tab" class="tab-content active">
    <div class="grid-dashboard">

        <div class="card col-span-full">
            <div class="card-header">Top Hashtags Performance</div>
            <div class="chart-container overflow-hidden">
                <canvas id="hashtagsChart"></canvas>
            </div>
        </div>

    </div>

    <div class="card col-span-full">
        <div class="card-header">Performance Deviation - Overperforming</div>
        <div class="overflow-x-auto">
            <table class="w-full text-left border-collapse" id="performanceDeviationPositiveTable">
                <thead>
                    <tr>
                        <th class="p-2 border-b border-white/10">Date</th>
                        <th class="p-2 border-b border-white/10">Network</th>
                        <th class="p-2 border-b border-white/10">Content</th>
                        <th class="p-2 border-b border-white/10">Engagement</th>
                        <th class="p-2 border-b border-white/10">Deviation</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <div class="card col-span-full">
        <div class="card-header">Performance Deviation - Underperforming</div>
        <div class="overflow-x-auto">
            <table class="w-full text-left border-collapse" id="performanceDeviationNegativeTable">
                <thead>
                    <tr>
                        <th class="p-2 border-b border-white/10">Date</th>
                        <th class="p-2 border-b border-white/10">Network</th>
                        <th class="p-2 border-b border-white/10">Content</th>
                        <th class="p-2 border-b border-white/10">Engagement</th>
                        <th class="p-2 border-b border-white/10">Deviation</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <div class="card col-span-full">
        <div class="card-header">Engagement Velocity (Viral Detection)</div>
        <div class="chart-container mb-4">
            <canvas id="velocityChart"></canvas>
        </div>
        <div class="overflow-x-auto">
            <table class="w-full text-left border-collapse" id="velocityTable">
                <thead>
                    <tr>
                        <th class="p-2 border-b border-white/10">Date</th>
                        <th class="p-2 border-b border-white/10">Content</th>
                        <th class="p-2 border-b border-white/10">Likes</th>
                        <th class="p-2 border-b border-white/10">Reposts</th>
                        <th class="p-2 border-b border-white/10">Total</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
</div>
</div>

<div id="engagement-tab" class="tab-content hidden">
    <div class="grid-dashboard">
        <div class="card">
            <div class="card-header">Content Type Performance</div>
            <div class="chart-container">
                <canvas id="postTypesChart"></canvas>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Network Efficiency</div>
            <div class="chart-container">
                <canvas id="networkEfficiencyChart"></canvas>
            </div>
        </div>
        <div class="card col-span-full">
            <div class="card-header">Top Mentions Performance</div>
            <div class="chart-container">
                <canvas id="mentionsChart"></canvas>
            </div>
        </div>

        <div class="card col-span-full">
            <div class="card-header">Top Collaborations</div>
            <div class="chart-container">
                <canvas id="collaborationsChart"></canvas>
            </div>
        </div>

        <div class="card">
            <div class="card-header">Engagement Rate (Normalized)</div>
            <div class="chart-container">
                <canvas id="engagementRateChart"></canvas>
            </div>
        </div>

        <div class="card">
            <div class="card-header">Follow Ratio Health</div>
            <div class="chart-container">
                <canvas id="followRatioChart"></canvas>
            </div>
        </div>
    </div>
</div>

<div id="timing-tab" class="tab-content hidden">
    <div class="card">
        <div class="card-header" id="timingCardHeader">Best Time to Post (Avg Likes)</div>
        <div class="relative w-full overflow-auto">
            <div id="heatmap-container" class="min-w-[600px] h-[500px]"></div>
        </div>
        <div class="text-sm text-muted mt-2 text-center">Day of Week x Hour of Day (Darker = Higher Engagement)</div>
    </div>

    <div class="card col-span-full mt-6">
        <div class="card-header">Posting Consistency (Last 365 Days)</div>
        <div class="relative w-full overflow-auto">
            <div id="calendar-heatmap-container" class="min-w-[800px] pb-4"></div>
        </div>
    </div>
</div>

<div id="wordcloud-tab" class="tab-content hidden">
    <div class="grid-dashboard">
        <div class="card col-span-full">
            <div class="card-header">Word Cloud (Top Usage)</div>
            <div class="chart-container h-600 overflow-hidden" id="word-cloud-container">
                <canvas id="wordCloudCanvas"></canvas>
            </div>
        </div>
        <div class="card col-span-full">
            <div class="card-header">Word Cloud (Top Engagement)</div>
            <div class="chart-container h-600 overflow-hidden" id="word-cloud-engagement-container">
                <canvas id="wordCloudEngagementCanvas"></canvas>
            </div>
        </div>
    </div>
</div>
</div>
</div>

<div id="website-tab" class="tab-content hidden">
    <div class="grid-dashboard">
        <div class="card col-span-full">
            <div class="card-header">Site Stats Over Time</div>
            <div class="chart-container">
                <canvas id="siteStatsChart"></canvas>
            </div>
        </div>
        <div class="card col-span-full">
            <div class="card-header">Top Viewed Pages</div>
            <div class="chart-container h-500">
                <canvas id="topPagesChart"></canvas>
            </div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/wordcloud2.js/1.2.2/wordcloud2.min.js"
    integrity="sha384-EuMVig/i0NsY8k6u37PJ4vzAbjRrxUknKzGF1JX32n8tasgHVvG817xx3+6WatZe"
    crossorigin="anonymous"></script>
<script src="/static/js/chartjs-adapter-date-fns.bundle.min.js"></script>
<script src="/static/js/analytics.js"></script>

{{ template "footer.html" . }}